{
  "_schema_version": "1.0",
  "_godot_version": "4.5",
  "_system_id": "S13",
  "_created": "2025-11-18",
  "_description": "Configuration for Color-Shift Health/Vibe Bar system",

  "vibe_bar_config": {
    "color_thresholds": {
      "high": {
        "percent": 1.0,
        "color": "#0080FF",
        "description": "Healthy state (100% - 51% HP)",
        "vibe_name": "Groovin'"
      },
      "mid": {
        "percent": 0.5,
        "color": "#FFFF00",
        "description": "Warning state (50% - 11% HP)",
        "vibe_name": "Shaky"
      },
      "low": {
        "percent": 0.1,
        "color": "#FF0000",
        "description": "Critical state (10% - 0% HP)",
        "vibe_name": "Off-Beat"
      }
    },

    "transition_speed": 0.3,
    "transition_easing": "ease_out_cubic",

    "pulse_at_percent": 0.2,
    "pulse_speed": 2.0,
    "pulse_scale_min": 0.95,
    "pulse_scale_max": 1.05,

    "particle_effects": {
      "yellow_sparks": {
        "threshold": 0.5,
        "enabled": true,
        "particle_count": 20,
        "lifetime": 0.5,
        "color": "#FFFF00",
        "explosiveness": 1.0,
        "one_shot": true,
        "description": "Yellow sparkles when crossing 50% HP threshold"
      },
      "red_warning": {
        "threshold": 0.1,
        "enabled": true,
        "particle_count": 30,
        "lifetime": 0.3,
        "color": "#FF0000",
        "explosiveness": 1.0,
        "one_shot": true,
        "description": "Red warning particles when crossing 10% HP threshold"
      },
      "defeat_explosion": {
        "threshold": 0.0,
        "enabled": true,
        "particle_count": 50,
        "lifetime": 1.0,
        "color": "#FF3333",
        "explosiveness": 1.0,
        "one_shot": true,
        "sync_with_downbeat": true,
        "description": "Defeat explosion particles on downbeat when HP reaches 0"
      }
    },

    "shader_settings": {
      "brightness": 1.0,
      "use_gradient": true,
      "shader_path": "res://shaders/color_shift_health.gdshader"
    },

    "ui_settings": {
      "show_percentage_text": true,
      "text_format": "%d%%",
      "text_color_matches_health": false,
      "bar_width": 200,
      "bar_height": 30
    },

    "debug": {
      "show_threshold_markers": false,
      "log_health_changes": false,
      "log_particle_triggers": false
    }
  },

  "integration_notes": {
    "combat_system": "Connects to Combatant.health_changed signal from S04",
    "conductor_system": "Uses Conductor.downbeat signal for defeat animation timing from S01",
    "usage": "Call vibe_bar.track_combatant(combatant_node) to set up automatic health tracking"
  },

  "visual_design_notes": {
    "color_philosophy": "Vibe Bar reflects the player's 'vibe' - when in sync with the rhythm (high HP), they're 'groovin'. As they take damage, they become 'shaky' and eventually 'off-beat'.",
    "feedback_strategy": "Multi-sensory feedback: color (shader), motion (pulse), particles (threshold crossings), timing (downbeat sync)",
    "accessibility": "Color transitions use distinct hues (blue, yellow, red) for color-blind accessibility"
  },

  "performance_targets": {
    "shader_overhead": "<0.01ms per frame",
    "particle_budget": "Max 100 particles on screen at once",
    "tween_optimization": "Kill old tween before creating new one",
    "memory_footprint": "<1MB per vibe bar instance"
  },

  "testing_scenarios": [
    {
      "name": "Full health display",
      "health_percent": 1.0,
      "expected_color": "Blue",
      "expected_state": "high"
    },
    {
      "name": "Mid-high transition",
      "health_percent": 0.75,
      "expected_color": "Blue-Yellow gradient",
      "expected_state": "high"
    },
    {
      "name": "Mid threshold",
      "health_percent": 0.5,
      "expected_color": "Yellow",
      "expected_state": "mid",
      "expected_particle": "yellow_sparks"
    },
    {
      "name": "Mid-low transition",
      "health_percent": 0.25,
      "expected_color": "Yellow-Red gradient",
      "expected_state": "mid"
    },
    {
      "name": "Pulse activation",
      "health_percent": 0.19,
      "expected_color": "Red",
      "expected_state": "low",
      "expected_pulse": true
    },
    {
      "name": "Low threshold",
      "health_percent": 0.1,
      "expected_color": "Red",
      "expected_state": "low",
      "expected_particle": "red_warning"
    },
    {
      "name": "Defeat",
      "health_percent": 0.0,
      "expected_color": "Red",
      "expected_state": "low",
      "expected_particle": "defeat_explosion",
      "expected_downbeat_sync": true
    }
  ]
}
